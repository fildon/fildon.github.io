<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Default Options Pattern in TypeScript</title>
    <meta name="description" content="I convenient pattern for">
    <link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="/static/prism.css">
  </head>
  <body>
    <header>
      <h1 class="home">
        <a href="/">Rupert &#39;fildon&#39; McKay</a>
      </h1>
    </header>
    <pre role="img" aria-label="RM">
â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ
â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ
    </pre>
    <article>
  <h2>Default Options Pattern in TypeScript</h2>
  <p>Here's a pattern I find myself reusing in a lot of projects:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">type</span> <span class="token class-name">FormatOptions</span> <span class="token operator">=</span> <span class="token punctuation">{</span><br>  color<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  fontWeight<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token punctuation">(</span><br>  message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span> color <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">,</span> fontWeight <span class="token operator">=</span> <span class="token string">"medium"</span> <span class="token punctuation">}</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span>FormatOptions<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">// Implementation not important for this blog post</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<h2>Explanation</h2>
<p>Imagine you have a function which can display some text formatted in a particular colour:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token function-variable function">format</span> <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">//</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"My message"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Format the text to be displayed in red</span></code></pre>
<p>But most of the time you don't want to have to specify a color, so it would be nice if the color argument were optional:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">//</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"My red message"</span><span class="token punctuation">,</span> <span class="token string">"red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// A red message</span><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"My black message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// A message using a sensible default color</span></code></pre>
<p>But now suppose I also want to support a font-weight option. We could provide two optional arguments, one after the other:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> color <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">,</span> fontWeight <span class="token operator">=</span> <span class="token string">"medium"</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">//</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"My medium black message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This works nicely!</span><br><br><span class="token comment">// ðŸš¨ I wanted bold fontWeight... but this is going to be treated as a color ðŸš¨</span><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"O no this won't work"</span><span class="token punctuation">,</span> <span class="token string">"bold"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>The problem is that we want a way to make <code>color</code> and <code>fontWeight</code> both optional, but if they are just optional parameters, then order matters. So we have to pick one to go before the other, and then we lose the ability to specify a later optional argument without also specifying an earlier one.</p>
<p>Instead we should wrap them up in an options object:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token punctuation">(</span><br>  message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    color <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">,</span><br>    fontWeight <span class="token operator">=</span> <span class="token string">"medium"</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> color<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> fontWeight<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><br><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">//</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"default formatted message"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This works!</span><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"A red message"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token string">"red"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Also works!</span><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"A bold message"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> fontWeight<span class="token operator">:</span> <span class="token string">"bold"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This works too!</span></code></pre>
<p>This is a perfectly good point to stop... however I don't entirely love having to pass an empty object in the case where we want all the defaults. What if instead the whole options object were itself optional?</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token punctuation">(</span><br>  message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span><br>    color <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">,</span><br>    fontWeight <span class="token operator">=</span> <span class="token string">"medium"</span><span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> color<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> fontWeight<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">//</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"A plain default message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now this is fine too!</span><br><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Formatting still works too"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> color<span class="token operator">:</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> fontWeight<span class="token operator">:</span> <span class="token string">"light"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Perfect! We get support for sensible defaults, while also allowing users to provide specific options only for the bits they care about.</p>
<p>The only thing I might do in this position is pull out the type of the options object for clarity:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">type</span> <span class="token class-name">FormatOptions</span> <span class="token operator">=</span> <span class="token punctuation">{</span><br>  color<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  fontWeight<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> format <span class="token operator">=</span> <span class="token punctuation">(</span><br>  message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><br>  <span class="token punctuation">{</span> color <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">,</span> fontWeight <span class="token operator">=</span> <span class="token string">"medium"</span> <span class="token punctuation">}</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span>FormatOptions<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">//</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Which brings us to where we started ðŸ˜€</p>
<p>That's all for today</p>
<p>Take care,</p>
<p>Rupert</p>

</article>
  </body>
</html>